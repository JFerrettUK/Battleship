(()=>{"use strict";function t(){let t=[];for(let e=0;e<10;e++){let e=[];for(let t=0;t<10;t++)e.push(null);t.push(e)}let e={},r=[],n=[],s=[],a=function(e,r,n){t[e][r]=n},o=function(t){e[t].hit()},l=function(t,e){r.push([t,e])},u=function(t,e){n.push([t,e])},c=function(t,e){s.push([t,e])},d=function(){if(r.length>=99)return["board full",[e,n]];let e=Math.floor(10*Math.random()),n=Math.floor(10*Math.random());if("missed"==t[e][n]||"hitShip"==t[e][n])return d();if(null==t[e][n])a(e,n,"missed"),l(e,n),u(e,n);else{let r=t[e][n].toString();o(r),a(e,n,"hitShip"),u(e,n)}return["hitBefore",[e,n]]};return{board:t,ships:e,listMissed:r,isMissed:function(t,e){return!!r.some((function(r){return r[0]===t&&r[1]===e}))},placeShip:function(r,n,i,s){if(function(t){e[`ship${t}`]=function(t){return function(t){return{length:t,hits:0,hit:function(){this.hits+=1},isSunk:function(){return this.hits>=this.length}}}(t)}(t)}(r),n>9||i>9)return"offBoard";if("vertical"==s){for(let e=i;e<r+i;e++){if(e>9)return"offBoard";if(null!==t[n][e])return"occupiedSquare"}for(let t=i;t<r+i;t++)a(n,t,`ship${r}`)}else{for(let e=n;e<r+n;e++){if(e>9)return"offBoard";if(null!==t[e][i])return"occupiedSquare"}for(let t=n;t<r+n;t++)a(t,i,`ship${r}`)}},receiveAttack:function(e,r){if(null==t[e][r])a(e,r,"missed"),l(e,r),u(e,r);else{if("missed"==t[e][r])return"hitBefore";if("hitShip"==t[e][r])return"hitBefore";{let n=t[e][r].toString();o(n),a(e,r,"hitShip"),c(e,r),u(e,r)}}},receiveAIAttack:function(e,n){if(r.length>=99)return["board full",[e,n]];if(null==t[e][n])a(e,n,"missed"),l(e,n),u(e,n);else{if("missed"==t[e][n])return"missed";if("hitShip"==t[e][n])return"hitBefore";{let r=t[e][n].toString();o(r),a(e,n,"hitShip"),u(e,n),c(e,n)}}},receiveRandomAIAttack:d,allSunk:function(){for(let t in e)if(1!=e[t].isSunk())return!1;return!0},anyMissed:function(){for(let e=0;e<10;e++)for(let r=0;r<10;r++)if("missed"===t[e][r])return[!0,[e,r]];return[!1,[]]},anyAttacks:function(){for(let e=0;e<10;e++)for(let r=0;r<10;r++)if("missed"===t[e][r]||"hitShip"===t[e][r])return[!0,[e,r]];return[!1,[]]},missedInARow:function(e){for(let e=0;e<10;e++)for(let e=0;e<10;e++)if("missed"===t[i][e])return[!0,[i,e]];return!1},saveAttacked:u,isHit:function(t,e){return!!s.some((function(r){return r[0]===t&&r[1]===e}))},isAttacked:function(t,e){return!!n.some((function(r){return r[0]===t&&r[1]===e}))},listAttacked:n,generatePotentialTargets:function(){const t=[];for(let e=0;e<10;e++)for(let r=0;r<10;r++)this.isAttacked(e,r)||t.push([e,r]);return t},listHit:s}}function e(t,e,r){let n;n="user"==r?document.getElementById(t+"-"+e+"-userBoard"):document.getElementById(t+"-"+e+"-aiBoard"),(n.classList.contains("blue")||n.classList.contains("cyan"))&&(n.classList.remove("blue"),n.classList.remove("cyan")),n.classList.contains("grey")&&n.classList.remove("grey"),"user"==r?n.classList.add("shipSquare"):n.classList.add("aiShipSquare")}function r(t,r,n,i){if(r>9||n>9)return"offBoard";if("vertical"==i){for(let e=n;e<t+n;e++){if(e>9)return"offBoard";if(document.getElementById(r+"-"+e+"-userBoard").classList.contains("shipSquare"))return"occupiedSquare"}for(let i=n;i<t+n;i++)e(r,i,"user")}else{for(let e=r;e<t+r;e++){if(e>9)return"offBoard";if(document.getElementById(e+"-"+n+"-userBoard").classList.contains("shipSquare"))return"occupiedSquare"}for(let i=r;i<t+r;i++)e(i,n,"user")}}function n(t,r,n,i){if(r>9||n>9)return"offBoard";if("vertical"==i){for(let e=n;e<t+n;e++){if(e>9)return"offBoard";if(document.getElementById(r+"-"+e+"-aiBoard").classList.contains("aiShipSquare"))return"occupiedSquare"}for(let i=n;i<t+n;i++)e(r,i,"ai")}else{for(let e=r;e<t+r;e++){if(e>9)return"offBoard";if(document.getElementById(e+"-"+n+"-aiBoard").classList.contains("aiShipSquare"))return"occupiedSquare"}for(let i=r;i<t+r;i++)e(i,n,"ai")}}function s(t,e){const r=[];return e>0&&r.push([t,e-1]),e<9&&r.push([t,e+1]),t>0&&r.push([t-1,e]),t<9&&r.push([t+1,e]),r}function a(t){const e=document.getElementsByClassName("announceCont")[0],r=e.querySelector("#announceText"),n=e.querySelector(".buttonContainer"),i=n.querySelector("button"),s=document.querySelector("#boardContainers");r.innerHTML="",s.innerHTML="","user"===t?(r.textContent="You win! Congratulations. Click below to play again.",s.innerHTML=""):"ai"===t&&(r.textContent="You lose! Better luck next time..."),e.style.display="grid",n.style.display="flex",i.style.display="inline-block",i.classList.add("playButton"),i.addEventListener("click",(()=>{location.reload()}))}!function(){let e=function(e){const r={name:"Hal",isTurn:!1,playerBoard:t()},n={name:e,isTurn:!0,playerBoard:t()},i=n.playerBoard.receiveRandomAIAttack.bind(n.playerBoard),s=n.playerBoard.receiveAIAttack.bind(n.playerBoard),a=r.playerBoard.receiveAttack.bind(r.playerBoard),o=function(){let t=0;return{whoseTurn:function(t,e){return 0==e.isTurn&&1==t.isTurn?"playerTurn":0==t.isTurn&&1==e.isTurn?"aiTurn":void 0},switchTurns:function(e,r){e.isTurn=!e.isTurn,r.isTurn=!r.isTurn,t+=1},getNo:function(){return t}}}(),l=r.playerBoard.placeShip.bind(r.playerBoard),u=n.playerBoard.placeShip.bind(n.playerBoard);return{ai:r,user:n,turns:o,attackPlayer:function(t,e){return"hitBefore"==s(t,e)?[[t,e],"hitBefore"]:(o.switchTurns(n,r),[t,e])},attackPlayerRandom:function(){let t=i()[1];return o.switchTurns(n,r),t},attackAI:function(t,e){return"hitBefore"==a(t,e)?[[t,e],"hitBefore"]:(o.switchTurns(n,r),[t,e])},placeAIShip:l,placeUserShip:u,placeTempShips:function(){l(2,2,1,"vertical"),l(3,4,4,"horizontal"),l(4,6,1,"horizontal"),l(5,4,5,"vertical"),u(2,2,1,"vertical"),u(3,4,3,"horizontal"),u(4,6,1,"horizontal"),u(5,4,5,"vertical")}}}("James");e.placeTempShips(),function(t){function e(e,r){for(let n=0;n<10;n++){const i=document.createElement("div");i.classList.add("battleSquare"),i.classList.add("userSquare"),i.dataset.row=e.toString(),i.dataset.column=n.toString(),"blue"==r?n%2==0?i.classList.add("blue"):i.classList.add("cyan"):n%2==0?i.classList.add("cyan"):i.classList.add("blue"),i.classList.contains("shipSquare")&&i.classList.remove("shipSquare"),i.id=`${e}-${n}-${t}`,document.getElementById(t).appendChild(i)}}document.getElementById(t).innerHTML="",function(){for(let t=0;t<10;t++)e(t,"blue"),t++,e(t,"cyan")}()}("userBoard"),function(t){function e(e,r){for(let r=0;r<10;r++){const n=document.createElement("div");n.classList.add("battleSquare"),n.classList.add("aiSquare"),n.classList.add("grey"),n.dataset.row=e.toString(),n.dataset.column=r.toString(),n.classList.contains("aiShipSquare")&&n.classList.remove("aiShipSquare"),n.id=`${e}-${r}-${t}`,document.getElementById(t).appendChild(n)}}document.getElementById(t).innerHTML="",function(){for(let t=0;t<10;t++)e(t)}()}("aiBoard"),n(2,2,1,"vertical"),n(3,4,4,"horizontal"),n(4,6,1,"horizontal"),n(5,4,5,"vertical"),r(2,2,1,"vertical"),r(3,4,3,"horizontal"),r(4,6,1,"horizontal"),r(5,4,5,"vertical"),function(t,e){document.querySelectorAll(".aiSquare").forEach((r=>{r.addEventListener("click",(()=>{const n=parseInt(r.dataset.row),i=parseInt(r.dataset.column);let a,o;r.classList.contains("aiShipSquare")?r.classList.add("hitShip"):(r.classList.add("missed"),n%2==0&&i%2==0||n%2!=0&&i%2!=0?r.classList.add("blue"):r.classList.add("cyan")),r.classList.add("flash"),setTimeout((()=>{r.classList.remove("flash")}),500);let l=[];const u=e.user.playerBoard.listHit,c=e.user.playerBoard.generatePotentialTargets();for(const t of u){const[r,n]=t,i=s(r,n);for(const t of i){const[r,n]=t;e.user.playerBoard.isAttacked(r,n)||l.push(t)}}let d;if(l.length>0){const t=l[0];d=[t[0],t[1]]}else d=c[Math.floor(Math.random()*c.length)];const f=10*d[0]+d[1];a=d[0],o=d[1];const h=document.querySelectorAll(".userSquare")[f];h.classList.contains("shipSquare")?h.classList.add("hitShip"):(h.classList.add("missed"),n%2==0&&i%2==0||n%2!=0&&i%2!=0?h.classList.add("blue"):h.classList.add("cyan")),h.classList.add("flash"),setTimeout((()=>{h.classList.remove("flash")}),500),t(n,i,a,o)}))}))}(((t,r,n,i)=>{e.attackAI(t,r),e.attackPlayer(n,i),e.user.playerBoard.allSunk()?a("ai"):e.ai.playerBoard.allSunk()&&a("user")}),e)}()})();